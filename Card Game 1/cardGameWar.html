<html lang="en" dir="ltr">

<head>
    <title>War!</title>
    <link rel="stylesheet" href="./cardGameWar.css">
    <style>
        body {
            background-color: lightsteelblue;
        }
    </style>
</head>
<header style="font-size: 250%; text-align: center">
    Card Game: War!
</header>

<body>
    <div class="footer">
        <button onclick="newGame()" type="button" class="buttons" id="newGame">New Game</button>
        <button onclick="nextRound()" type="button" class="buttons" id="nextRound">Next Round</button>
        <br>
        <button onclick="discToDeck()" type="button" class="buttons" id="discToDeck">Shuffle Discard Pile Into Deck</button>
    </div>
    <div class="row">
        <div class="column side">
            <h2 class="p1Dec">Student</h2>
            <h3 id="p1DeckHead">Hand (26)</h3>
            <div class="deck">
                <img onmouseover="getDeckCount(this)" class="cards" id="p1Play" src="./Card_Example/Deck/purple_back.jpg"></img>
                <!-- <div class="inside">
                    <div class="text">John Doe</div>
                </div> -->
            </div>
            <h3 id="p1DiscHead">Discard Pile (0)</h3>
            <div class="discard">
                <img onmouseover="getDiscCount(this)" class="cards" id="p1Disc" src='./Card_Example/Deck/Yellow_back.jpg'></img>
            </div>
        </div>


        <div class="column middle">
            <h2> Playing Field</h2>
            <h3 id="rounds"> Rounds Played: 0 </h3>
            <div class="column middle L">
                <img class="cards" id="p1Deck" src='./Card_Example/Deck/Red_back.jpg'></img>
            </div>
            <div class="column middle R">
                <img class="cards" id="p2Deck" src='./Card_Example/Deck/Red_back.jpg'></img>
            </div>
            <div class="column middle M">
                <h1 id="win"></h1>
            </div>
        </div>


        <div class="column side">
            <h2 class="p2Dec">Michaels</h2>
            <h3 id="p2DeckHead">Hand (26)</h3>
            <div class="deck">
                <img onmouseover="getDeckCount(this)" class="cards" id="p2Play" src="./Card_Example/Deck/purple_back.jpg"></img>
                <!-- <div class="inside">
                    <div class="text">John Doe</div>
                </div> -->
            </div>
            <h3 id="p2DiscHead">Discard Pile (0)</h3>
            <div class="discard">
                <img onmouseover="getDiscCount(this)" class="cards" id="p2Disc" src='./Card_Example/Deck/Yellow_back.jpg'></img>
            </div>
        </div>
    </div>


    <script src="Card_Example/card.js"></script>
    <script>
        var rounds = 0;
        var state = 0;
        var pl1Deck = [];
        var pl2Deck = [];
        var pl1Disc = [];
        var pl2Disc = [];
        var tmp = new Deck();

        for (var i = 0; i < 26; i++) {
            pl1Deck[i] = tmp.deck[i];
        }
        for (var i = 0; i < 26; i++) {
            pl2Deck[i] = tmp.deck[i + 26];
        }
        // console.log(tmp.deck);
        // console.log(pl1Deck);
        // console.log(pl2Deck);

        function newGame() {
            pl1Deck = [];
            pl2Deck = [];
            pl1Disc = [];
            pl2Disc = [];
            tmp = new Deck()
            for (var i = 0; i < 26; i++) {
                pl1Deck[i] = tmp.deck[i];
            }
            for (var i = 0; i < 26; i++) {
                pl2Deck[i] = tmp.deck[i + 26];
            }

            rounds = 0;
            document.getElementById('rounds').innerHTML = "Rounds Played: " + rounds;
            document.getElementById('p1Deck').src = './Card_Example/Deck/Red_back.jpg';
            document.getElementById('p2Deck').src = './Card_Example/Deck/Red_back.jpg';
            document.getElementById('p1Disc').src = './Card_Example/Deck/Yellow_back.jpg';
            document.getElementById('p2Disc').src = './Card_Example/Deck/Yellow_back.jpg';
            document.getElementById('p1DiscHead').innerHTML = "Discard Pile (" + pl1Disc.length + ")";
            document.getElementById('p2DiscHead').innerHTML = "Discard Pile (" + pl2Disc.length + ")";
            document.getElementById('p1DeckHead').innerHTML = "Hand (" + pl1Deck.length + ")";
            document.getElementById('p2DeckHead').innerHTML = "Hand (" + pl2Deck.length + ")";
            document.getElementById('win').innerHTML = "Decks have been reset";

        }

        function getDeckCount(x) {
            if (x.id == "p1Play") {
                console.log(pl1Deck.length);
            } else {
                console.log(pl2Deck.length);
            }
        }

        function getDiscCount(x) {
            if (x.id == "p1Disc") {
                console.log(pl1Disc.length);
            } else {
                console.log(pl2Disc.length);
            }
        }

        function nextRound() {
            // console.log(pl1Deck.length);
            // console.log(pl2Deck.length);
            var pCardPlayed = get_top_card(pl1Deck);
            var mCardPlayed = get_top_card(pl2Deck);
            var pWon = false;
            var winDiv = document.getElementById('win');
            document.getElementById('p1Deck').src = pCardPlayed.icon;
            document.getElementById('p2Deck').src = mCardPlayed.icon;
            pWon = p1Won(pCardPlayed, mCardPlayed);

            if (pl1Disc.length != 0) {
                document.getElementById('p1DiscHead').innerHTML = "Discard Pile (" + pl1Disc.length + ")";
                document.getElementById('p1Disc').src = pl1Disc[pl1Disc.length - 2].icon;
            }
            if (pl2Disc.length != 0) {
                document.getElementById('p2DiscHead').innerHTML = "Discard Pile (" + pl2Disc.length + ")";
                document.getElementById('p2Disc').src = pl2Disc[pl2Disc.length - 1].icon;
            }
            if (pWon) {
                winDiv.innerHTML = "^== Player wins this round!";
                pl1Disc.push(pCardPlayed, mCardPlayed);
            } else {
                winDiv.innerHTML = "Michaels wins this round! ==^";
                pl2Disc.push(pCardPlayed, mCardPlayed);
            }

            if (pl1Deck.length == 0 || pl2Deck.length == 0) {
                document.getElementById('discToDeck').style.opacity = "1";
                document.getElementById('nextRound').disabled = true;
                if (pl1Deck.length == 0) {
                    alert("Player 1 has ran out of cards in their hand. Shuffling discard pile into hand")
                }
                if (pl2Deck.length == 0) {
                    alert("Player 2 has ran out of cards in their hand. Shuffling discard pile into hand")
                }
            }
            rounds++;
            document.getElementById('rounds').innerHTML = "Rounds Played: " + rounds;
            document.getElementById('p1DeckHead').innerHTML = "Hand (" + pl1Deck.length + ")";
            document.getElementById('p2DeckHead').innerHTML = "Hand (" + pl2Deck.length + ")";

            // console.log(pl1Deck.length);
            // console.log(pl2Deck.length);
            // console.log(pCardPlayed);
            // console.log(mCardPlayed);
            // console.log(pl1Deck);
            // console.log(pl1Disc);
            // console.log(pl2Disc);

        }

        function discToDeck() {
            // alert(pl1Deck.length)
            var pCardInPlay = document.getElementById('p1Deck');
            var mCardInPlay = document.getElementById('p2Deck');
            var pWon = p1Won(pCardInPlay, mCardInPlay);
            var winDiv = document.getElementById('win');
            if (pl1Deck.length == 0 && pl2Deck.length == 0) {
                winDiv.innerHTML = "Both players shuffled their discard pile into their hand";
            } else if (pl1Deck.length == 0) {
                winDiv.innerHTML = "Player 1 shuffled their discard pile into their hand";
            } else if (pl2Deck.length == 0) {
                winDiv.innerHTML = "Michaels shuffled their discard pile into their hand";
            }
            if (pl1Deck.length == 0 || pl2Deck.length == 0) {
                document.getElementById('p1Deck').src = './Card_Example/Deck/Red_back.jpg';
                document.getElementById('p1Disc').src = './Card_Example/Deck/Yellow_back.jpg';
                pl1Deck.push.apply(pl1Deck, pl1Disc);
                pl1Disc = [];
                document.getElementById('p1DiscHead').innerHTML = "Discard Pile (" + pl1Disc.length + ")";
                shuffle(pl1Deck);
                document.getElementById('p2Deck').src = './Card_Example/Deck/Red_back.jpg';
                document.getElementById('p2Disc').src = './Card_Example/Deck/Yellow_back.jpg';
                pl2Deck.push.apply(pl2Deck, pl2Disc);
                pl2Disc = [];
                document.getElementById('p2DiscHead').innerHTML = "Discard Pile (" + pl1Disc.length + ")";
                shuffle(pl2Deck);
            }
            document.getElementById('p1DeckHead').innerHTML = "Hand (" + pl1Deck.length + ")";
            document.getElementById('p2DeckHead').innerHTML = "Hand (" + pl2Deck.length + ")";
            document.getElementById('discToDeck').style.opacity = "0";
            document.getElementById('nextRound').disabled = false;

        }

        function p1Won(pCardPlayed, mCardPlayed) {
            if (pCardPlayed.face > mCardPlayed.face) {
                return true;

            } else if (pCardPlayed.face == mCardPlayed.face) {
                if (compareSuits(pCardPlayed.suit, mCardPlayed.suit) === "player1") {
                    return true;
                }
            }
            return false;
        }

        function compareSuits(card1Suit, card2Suit) {
            if (card1Suit == "Spades") {
                return "player1";
            } else if (card1Suit == "Daimonds" && card2Suit != "Spades") {
                return "player1";
            } else if (card1Suit == "Clubs" && card2Suit == "Hearts") {
                return "player1";
            } else {
                return "player2";
            }
        }
    </script>
</body>

</html>